webpackJsonp([23],{"2ACE":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=t("bOdI"),o=t.n(l),a=t("P9l9"),n={name:"createCoupon",data:function(){var e;return{transferData:[],transfer:[],filterMethod:function(e,r){return r.label.indexOf(e)>-1},loading:!1,channels:[],channelLabel:[],channelOption:[],channelIndeterminate:!1,stores:[],storeLabel:[],storeOption:[],storeIndeterminate:!1,ruleForm:(e={channelCheckAll:!0,storeCheckAll:!0,couponType:"",couponTypes:[],couponName:"",effectTime:"",expirationTime:"",terminalPrice:"",evidence:"",channels:[],stores:[],couponNote:"",carOwnerNote:"",businessNote:"",typeBg:"",typeBgs:[],storesOptions:[],channelsOptions:[]},o()(e,"channels",[]),o()(e,"stores",[]),e),rules:{couponName:[{max:10,message:"名称最多10个字符",trigger:"blur"},{required:!0,message:"请输入卡券名称",trigger:"blur"}],couponType:[{required:!0,message:"请选择卡券类型",trigger:"change"}],effectTime:[{required:!0,message:"请选择生效时间",trigger:"change"}],expirationTime:[{required:!0,message:"请选择过期时间",trigger:"change"}],channels:[{required:!0,type:"array",message:"请选择适用渠道",trigger:"change"}],stores:[{required:!0,type:"array",message:"请选择适用商户",trigger:"change"}],terminalPrice:[{required:!0,validator:function(e,r,t){return r?/^((\d+)|([0].\d{0,2}|(\d+.\d{0,2})))$/.test(r)?void t():(t(new Error("价格只能为数字且保留两位小数")),!1):t(new Error("价格不能为空"))},trigger:"blur"}],evidence:[{type:"number",message:"数量必须为数字值"},{required:!0,message:"请填写佐证数量",trigger:"blur"}]}}},methods:{changTransfer:function(e){console.log(e),console.log(this.ruleForm.channels)},storeCheckAllChange:function(e){this.ruleForm.storesOptions=e?this.storeLabel:[],this.storeIndeterminate=!1},channelCheckAllChange:function(e){this.ruleForm.channelsOptions=e?this.channelLabel:[],this.channelIndeterminate=!1},storesOptionsChange:function(e){var r=e.length;this.ruleForm.storeCheckAll=r===this.storeOption.length,this.storeIndeterminate=r>0&&r<this.ruleForm.storesOptions.length},channelchannelsChange:function(e){var r=e.length;this.ruleForm.channelCheckAll=r===this.channelOption.length,this.channelIndeterminate=r>0&&r<this.ruleForm.channelsOptions.length},getDicts:function(){var e=this;Object(a.q)({itemType:"cardType"}).then(function(r){for(var t in r.data.body){var l={label:r.data.body[t],value:t};e.ruleForm.couponTypes.push(l)}})},getSelect:function(){var e=this;Object(a.w)({},!0).then(function(r){1==r.data.code&&(e.storeOption=r.data.body.data,e.storeOption.forEach(function(r){e.ruleForm.storesOptions.push(r.name),r.label=r.name,r.key=r.id,e.storeLabel.push(r)}))}),Object(a.j)({}).then(function(r){1==r.data.code&&(e.channelOption=r.data.body.data,e.channelOption.forEach(function(r){e.ruleForm.channelsOptions.push(r.chName),r.label=r.chName,r.key=r.chid,e.channelLabel.push(r)}))})},cardClass:function(){var e=this,r=!1;if(this.$refs.leftForm.$children.forEach(function(t,l){if("需要佐证数量"==t.label&&"0"==t.fieldValue);else if(t.isRequired&&""==t.fieldValue)throw e.$message.error(t.label+"不能为空!"),r=!0,new Error("表单验证错误")}),!r&&(this.$refs.rightForm.$children.forEach(function(t,l){if(t.isRequired&&""==t.fieldValue)throw e.$message.error(t.label+"不能为空!"),r=!0,new Error("表单验证错误")}),!r)){var t={name:this.ruleForm.couponName,staTime:this.ruleForm.effectTime,expTime:this.ruleForm.expirationTime,price:this.ruleForm.terminalPrice,needProveNum:this.ruleForm.evidence,cardExplain:this.ruleForm.couponNote,userExplain:this.ruleForm.carOwnerNote,merchantExplain:this.ruleForm.businessNote,type:this.ruleForm.couponType,applyChannel:this.ruleForm.channels.toString(),applyStore:this.ruleForm.stores.toString(),uid:JSON.parse(window.sessionStorage.getItem("user")).uid};this.loading=!0,Object(a.f)(t,"edit").then(function(r){e.loading=!1,1==r.data.code?(e.$notify({title:"成功",message:r.data.msg,type:"success"}),e.$router.push("/couponList")):e.$notify.error({title:"错误",message:r.data.msg})})}}},created:function(){this.getSelect(),this.getDicts()},mounted:function(){}},s={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"createCoupon"},[t("el-row",{attrs:{type:"flex"}},[t("el-col",{attrs:{span:11}},[t("el-form",{ref:"leftForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"卡券类型:",prop:"couponType"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.couponType,callback:function(r){e.$set(e.ruleForm,"couponType",r)},expression:"ruleForm.couponType"}},e._l(e.ruleForm.couponTypes,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"卡券名称",prop:"couponName"}},[t("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.couponName,callback:function(r){e.$set(e.ruleForm,"couponName",r)},expression:"ruleForm.couponName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"生效时间",prop:"effectTime"}},[t("el-date-picker",{attrs:{"default-time":"00:00:00",type:"datetime","value-format":"yyyyMMddHHmmss",placeholder:"选择生效时间"},model:{value:e.ruleForm.effectTime,callback:function(r){e.$set(e.ruleForm,"effectTime",r)},expression:"ruleForm.effectTime"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"过期时间",prop:"expirationTime"}},[t("el-date-picker",{attrs:{"value-format":"yyyyMMddHHmmss","default-time":"23:59:59",type:"datetime",placeholder:"选择过期时间"},model:{value:e.ruleForm.expirationTime,callback:function(r){e.$set(e.ruleForm,"expirationTime",r)},expression:"ruleForm.expirationTime"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"终端价格",prop:"terminalPrice"}},[t("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.terminalPrice,callback:function(r){e.$set(e.ruleForm,"terminalPrice",r)},expression:"ruleForm.terminalPrice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"需要佐证数量",prop:"evidence"}},[t("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.evidence,callback:function(r){e.$set(e.ruleForm,"evidence",e._n(r))},expression:"ruleForm.evidence"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"卡券说明",prop:"couponNote"}},[t("el-input",{attrs:{clearable:"",type:"textarea",maxlength:"100",rows:4,"show-word-limit":""},model:{value:e.ruleForm.couponNote,callback:function(r){e.$set(e.ruleForm,"couponNote",r)},expression:"ruleForm.couponNote"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"车主说明",prop:"carOwnerNote"}},[t("el-input",{attrs:{clearable:"",type:"textarea",maxlength:"100",rows:4,"show-word-limit":""},model:{value:e.ruleForm.carOwnerNote,callback:function(r){e.$set(e.ruleForm,"carOwnerNote",r)},expression:"ruleForm.carOwnerNote"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商户说明",prop:"businessNote"}},[t("el-input",{attrs:{clearable:"",type:"textarea",maxlength:"100",rows:4,"show-word-limit":""},model:{value:e.ruleForm.businessNote,callback:function(r){e.$set(e.ruleForm,"businessNote",r)},expression:"ruleForm.businessNote"}})],1)],1)],1),e._v(" "),t("el-col",{attrs:{span:13}},[t("el-form",{ref:"rightForm",attrs:{"status-icon":"",model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"适用渠道",prop:"channels"}},[t("el-transfer",{attrs:{filterable:"","filter-method":e.filterMethod,"button-texts":["不适用","适用"],"filter-placeholder":"请输入渠道名称",titles:["全部渠道","适用渠道"],data:e.channelLabel},on:{change:e.changTransfer},model:{value:e.ruleForm.channels,callback:function(r){e.$set(e.ruleForm,"channels",r)},expression:"ruleForm.channels"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"适用商户",prop:"stores"}},[t("el-transfer",{attrs:{filterable:"","filter-method":e.filterMethod,"button-texts":["不适用","适用"],"filter-placeholder":"请输入商户名称",titles:["全部商户","适用商户"],data:e.storeLabel},on:{change:e.changTransfer},model:{value:e.ruleForm.stores,callback:function(r){e.$set(e.ruleForm,"stores",r)},expression:"ruleForm.stores"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"卡券背景类型",prop:"typeBg"}},[t("el-select",{model:{value:e.ruleForm.typeBg,callback:function(r){e.$set(e.ruleForm,"typeBg",r)},expression:"ruleForm.typeBg"}},e._l(e.ruleForm.typeBgs,function(e,r){return t("el-option",{key:r,attrs:{value:e.value,label:e.label}})}),1)],1)],1)],1)],1),e._v(" "),t("div",{staticClass:"btn"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.cardClass}},[e._v("创建")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:function(r){return e.$router.push("/couponList")}}},[e._v("取消")])],1),e._v(" "),t("div",{staticClass:"space"})],1)},staticRenderFns:[]};var i=t("VU/8")(n,s,!1,function(e){t("XxfU")},"data-v-26374cef",null);r.default=i.exports},XxfU:function(e,r){}});
//# sourceMappingURL=23.1a076e48ea59cff8b78e.js.map