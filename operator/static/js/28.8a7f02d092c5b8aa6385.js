webpackJsonp([28],{"9qw8":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("bOdI"),r=t.n(n),l=t("P9l9"),o=t("0w2Z"),c={name:"couponListing",filters:{time:function(e){return Object(o.b)(e)},date:function(e){return Object(o.c)(e)},status:function(e){switch(e){case"1":return"未使用";case"2":return"已使用";case"3":return"已过期";case"4":return"已失效";default:return""}},examineStatus:function(e){switch(e){case"0":return"未审核";case"1":return"通过";case"2":return"不通过";default:return"暂无"}},empty:function(e){return""==e?"暂无":e}},computed:{rows:function(){var e=[];return this.cardConsume.provePicture.forEach(function(a,t){var n=Math.floor(t/4);e[n]||(e[n]=[]),e[n].push(a)}),e}},data:function(){return{dialogVisible:!1,tableData:[],formData:{keyword:"",status:"",couponStatus:[{label:"未使用",value:1},{label:"已使用",value:2},{label:"已过期",value:3},{label:"已失效",value:4}],couponTypes:[],couponType:"",attribution:"",aschidLevel:"",attributions:[],channel:"",chLevel:"",channels:[]},cardRecord:{cardCode:"---",sendTime:"---",cardStatus:"---",scanNum:"---",couponData:[],cardExplain:"",userExplain:"",merchantExplain:""},cardConsume:{provePicture:[],userData:[]},evaluate:{evaluate:"",insTime:"",userId:""},cardExamine:{examineOpinion:"",examineStatus:"",examineTime:"",examineUserName:""},page:1,pageSize:20,total:0,loading:!1,bigPic:!1,bigUrl:"",loadingImage:!1}},methods:{getDicts:function(){var e=this;Object(l.q)({itemType:"cardType"}).then(function(a){for(var t in a.data.body){var n={label:a.data.body[t],value:t};e.formData.couponTypes.push(n)}})},showBigPic:function(e){var a=this;this.bigPic=!0,this.loadingImage=!0;var t="";this.bigUrl="",getImages({fi:e}).then(function(e){t="data:image/png;base64,"+btoa(new Uint8Array(e.data).reduce(function(e,a){return e+String.fromCharCode(a)},"")),a.loadingImage=!1,a.bigUrl=t})},changeChannle:function(e){var a=this;this.formData.channels.forEach(function(t){e==t.value&&(a.formData.chLevel=t.chLevel)})},changeAttr:function(e){var a=this;this.formData.channels.forEach(function(t){e==t.value&&(a.formData.aschidLevel=t.chLevel)})},handleSizeChange:function(e){this.pageSize=e,this.getCardRecord()},handleCurrentChange:function(e){this.page=e,this.getCardRecord()},showDetail:function(e){var a=this;Object(l.g)({id:e}).then(function(e){if(1==e.data.code){if(e.data.body.cardConsume){a.cardConsume=e.data.body.cardConsume,a.cardConsume.provePicture=e.data.body.cardConsume.provePicture.split(","),a.cardConsume.userData=[];var t={ownerName:e.data.body.cardConsume.ownerName,ownerPhone:e.data.body.cardConsume.ownerPhone,licenseno:e.data.body.cardConsume.licenseno,consumeTime:e.data.body.cardConsume.consumeTime,storeName:e.data.body.cardConsume.storeName,storePrices:e.data.body.cardConsume.storePrices};a.cardConsume.userData.push(t)}if(e.data.body.cardExamine&&(a.cardExamine=e.data.body.cardExamine),e.data.body.cardRecord){var n;a.cardRecord=e.data.body.cardRecord;var l=(n={cardName:e.data.body.cardRecord.cardName,cardExpTime:e.data.body.cardRecord.cardExpTime,cardStaTime:e.data.body.cardRecord.cardStaTime,channelName:e.data.body.cardRecord.channelName,channelPrices:e.data.body.cardRecord.channelPrices,cardPrice:e.data.body.cardRecord.cardPrice,needProveNum:e.data.body.cardRecord.needProveNum},r()(n,"cardPrice",e.data.body.cardRecord.cardPrice),r()(n,"cardExplain",e.data.body.cardRecord.cardExplain),r()(n,"userExplain",e.data.body.cardRecord.userExplain),r()(n,"merchantExplain",e.data.body.cardRecord.merchantExplain),n);a.cardRecord.couponData=[],a.cardRecord.couponData.push(l)}e.data.body.evaluate&&(a.evaluate=e.data.body.evaluate)}}),this.dialogVisible=!0},getCardRecord:function(){var e=this,a={keyWord:this.formData.keyword,page:this.page-1,pageSize:this.pageSize,cardStatus:this.formData.status,dichid:this.formData.channel,dichidLevel:this.formData.chLevel,aschid:this.formData.attribution,aschidLevel:this.formData.aschidLevel};this.loading=!0,Object(l.h)(a).then(function(a){e.loading=!1,1==a.data.code&&(e.tableData=a.data.body.data,e.total=a.data.body.count)})},channel:function(){var e=this;Object(l.j)().then(function(a){1==a.data.code&&a.data.body.data.forEach(function(a){var t={label:a.chName,value:a.chid,chLevel:a.chLevel};e.formData.channels.push(t),e.formData.attributions.push(t)})})}},created:function(){this.getDicts()},mounted:function(){this.getCardRecord(),this.channel()}},i={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"couponListing"},[e.dialogVisible?e._e():t("div",[t("el-form",{staticClass:"form",attrs:{"label-width":"0.8rem",inline:!0}},[t("el-form-item",{attrs:{label:"关键字:"}},[t("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入卡券编号或名称"},model:{value:e.formData.keyword,callback:function(a){e.$set(e.formData,"keyword",a)},expression:"formData.keyword"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"卡券状态:"}},[t("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择"},model:{value:e.formData.status,callback:function(a){e.$set(e.formData,"status",a)},expression:"formData.status"}},e._l(e.formData.couponStatus,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"卡券类型:"}},[t("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择"},model:{value:e.formData.couponType,callback:function(a){e.$set(e.formData,"couponType",a)},expression:"formData.couponType"}},e._l(e.formData.couponTypes,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"分发渠道:"}},[t("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择"},on:{change:e.changeChannle},model:{value:e.formData.channel,callback:function(a){e.$set(e.formData,"channel",a)},expression:"formData.channel"}},e._l(e.formData.channels,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"归属渠道:"}},[t("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择"},on:{change:e.changeAttr},model:{value:e.formData.attribution,callback:function(a){e.$set(e.formData,"attribution",a)},expression:"formData.attribution"}},e._l(e.formData.attributions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.getCardRecord}},[e._v("查询")])],1)],1),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"couponList"},[t("h2",[e._v("数据列表")]),e._v(" "),t("el-table",{staticStyle:{width:"98%",margin:".1rem"},attrs:{border:"",height:"5.6rem",size:"small",data:e.tableData}},[t("el-table-column",{attrs:{align:"center",prop:"cardCode",label:"卡券编号"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",prop:"cardTypeName",label:"卡券类型"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",prop:"cardName",label:"卡券名称"}}),e._v(" "),t("el-table-column",{attrs:{align:"center","min-width":"100px",prop:"cardStaTime",label:"生效时间"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("p",[e._v(e._s(e._f("date")(n.cardStaTime)))])]}}],null,!1,2700457490)}),e._v(" "),t("el-table-column",{attrs:{align:"center","min-width":"100px",prop:"cardExpTime",label:"过期时间"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("p",[e._v(e._s(e._f("date")(n.cardExpTime)))])]}}],null,!1,3554133625)}),e._v(" "),t("el-table-column",{attrs:{align:"center",prop:"cardStatus",label:"卡券状态"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("p",[e._v(e._s(e._f("status")(n.cardStatus)))])]}}],null,!1,508758133)}),e._v(" "),t("el-table-column",{attrs:{align:"center",prop:"channelName",label:"分发渠道"}}),e._v(" "),t("el-table-column",{attrs:{align:"center",prop:"belongChName",label:"归属渠道"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.showDetail(n.id)}}},[e._v("查看详情")])]}}],null,!1,447979455)})],1),e._v(" "),t("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":e.page,"page-sizes":[20,100,200,300,400],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),t("transition",{attrs:{name:"el-zoom-in-top",mode:"out-in"}},[e.dialogVisible?t("div",{staticClass:"detail"},[t("div",{staticClass:"detailContent"},[t("h2",[e._v("卡券详情 "),t("i",{staticClass:"el-icon-circle-close",on:{click:function(a){e.dialogVisible=!1}}})]),e._v(" "),t("div",{staticClass:"downCon"},[t("p",[e._v("卡券信息")]),e._v(" "),t("div",{staticClass:"detailMsg"},[t("p",[t("span",[e._v("卡券编号:")]),t("b",[e._v(e._s(e._f("empty")(e.cardRecord.cardCode)))])]),e._v(" "),t("p",[t("span",[e._v("创建时间:")]),t("b",[e._v(e._s(e._f("empty")(e._f("time")(e.cardRecord.sendTime))))])]),e._v(" "),t("p",[t("span",[e._v("卡券状态:")]),t("b",[e._v(e._s(e._f("status")(e.cardRecord.cardStatus)))])]),e._v(" "),t("p",[t("span",[e._v("扫码次数:")]),t("b",[e._v(e._s(e._f("empty")(e.cardRecord.scanNum))+"次")])])]),e._v(" "),t("el-table",{staticClass:"table",staticStyle:{width:"95%"},attrs:{border:"",size:"small",data:e.cardRecord.couponData}},[t("el-table-column",{attrs:{prop:"cardName",align:"center",label:"卡券名称"}}),e._v(" "),t("el-table-column",{attrs:{prop:"cardStaTime",align:"center",label:"有效时间"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("span",[e._v(e._s(e._f("date")(n.cardStaTime)))])]}}],null,!1,1686106062)}),e._v(" "),t("el-table-column",{attrs:{prop:"cardExpTime",align:"center",label:"过期时间"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("span",[e._v(e._s(e._f("date")(n.cardExpTime)))])]}}],null,!1,2578356293)}),e._v(" "),t("el-table-column",{attrs:{prop:"channelName",align:"center",label:"分发渠道"}}),e._v(" "),t("el-table-column",{attrs:{prop:"channelPrices",align:"center",label:"渠道价格"}}),e._v(" "),t("el-table-column",{attrs:{prop:"cardPrice",align:"center",label:"终端价格"}}),e._v(" "),t("el-table-column",{attrs:{prop:"needProveNum",align:"center",label:"所需佐证数"}})],1),e._v(" "),t("div",{staticClass:"note"},[t("p",[e._v("卡券说明: "),t("span",[e._v(e._s(e._f("empty")(e.cardRecord.cardExplain)))])]),e._v(" "),t("p",[e._v("车主说明: "),t("span",[e._v(e._s(e._f("empty")(e.cardRecord.userExplain)))])]),e._v(" "),t("p",[e._v("商户说明: "),t("span",[e._v(e._s(e._f("empty")(e.cardRecord.merchantExplain)))])])]),e._v(" "),t("p",[e._v("发送信息")]),e._v(" "),t("div",{staticClass:"send"},[t("p",[e._v("发送人: "),t("span",[e._v(e._s(e._f("empty")(e.cardRecord.ownerName)))])]),e._v(" "),t("p",[e._v("手机号: "),t("span",[e._v(e._s(e._f("empty")(e.cardRecord.ownerPhone)))])]),e._v(" "),t("p",[e._v("车牌号: "),t("span",[e._v(e._s(e._f("empty")(e.cardRecord.licenseno)))])])]),e._v(" "),t("p",[e._v("使用信息")]),e._v(" "),t("el-table",{staticClass:"table",staticStyle:{width:"95%"},attrs:{border:"",size:"small",data:e.cardConsume.userData}},[t("el-table-column",{attrs:{prop:"ownerName",align:"center",label:"使用人"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ownerPhone",align:"center",label:"手机号码"}}),e._v(" "),t("el-table-column",{attrs:{prop:"licenseno",align:"center",label:"车牌号码"}}),e._v(" "),t("el-table-column",{attrs:{prop:"storePrices",align:"center",label:"合作价格"}}),e._v(" "),t("el-table-column",{attrs:{prop:"consumeTime",align:"center",label:"使用时间"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("span",[e._v(e._s(e._f("time")(n.consumeTime)))])]}}],null,!1,1901655249)}),e._v(" "),t("el-table-column",{attrs:{prop:"storeName",align:"center",label:"扫码商户"}})],1),e._v(" "),t("p",[e._v("佐证信息")]),e._v(" "),t("div",{staticClass:"edvince"},[0==e.rows.length?t("p",{staticStyle:{"font-size":".16rem","text-indent":"2em","font-weight":"normal"}},[e._v("暂无佐证")]):e._l(e.rows,function(a,n){return t("el-row",{key:n,attrs:{type:"flex"}},e._l(a,function(a){return t("el-col",{key:a,attrs:{span:8}},[t("div",{staticStyle:{display:"flex","justify-content":"center","align-item":"center"}},[t("img",{staticStyle:{width:"2rem"},attrs:{src:"http://sapp.csgxcf.com:2800/seeRecrop?fi="+a+"&sc=0&w=300&h=300"},on:{click:function(t){return e.showBigPic(a)}}})])])}),1)})],2),e._v(" "),t("p",[e._v("评价信息")]),e._v(" "),t("div",{staticClass:"evaluation"},[e._v("\n                          "+e._s(e._f("empty")(e.evaluate.evaluate))+"\n                          "),t("div",{staticClass:"evaluationFoot"},[t("span",[e._v("评价人: "),t("span",[e._v(e._s(e._f("empty")(e.evaluate.ownerName)))])]),e._v(" "),t("span",[e._v("评价时间: "),t("span",[e._v(e._s(e._f("empty")(e._f("time")(e.evaluate.insTime))))])])])]),e._v(" "),t("p",[e._v("审核信息")]),e._v(" "),t("div",{staticClass:"audit"},[t("p",[e._v("审核人:   "),t("span",[e._v(" "+e._s(e._f("empty")(e.cardExamine.examineUserName)))])]),e._v(" "),t("p",[e._v("审核时间:   "),t("span",[e._v(e._s(e._f("empty")(e.cardExamine.examineTime)))])]),e._v(" "),t("p",[e._v("审核结果:   "),t("span",[e._v(e._s(e._f("empty")(e.cardExamine.examineOpinion))+"("+e._s(e._f("examineStatus")(e.cardExamine.examineStatus))+")")])])]),e._v(" "),t("div",{staticStyle:{height:"2rem"}})],1),e._v(" "),t("el-dialog",{attrs:{title:"查看佐证",visible:e.bigPic,width:"50%"},on:{"update:visible":function(a){e.bigPic=a}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingImage,expression:"loadingImage"}],staticStyle:{display:"flex","justify-content":"center","align-item":"center"}},[t("img",{staticStyle:{"max-width":"5rem"},attrs:{src:e.bigUrl,alt:""}})])])],1)]):e._e()])],1)},staticRenderFns:[]};var s=t("VU/8")(c,i,!1,function(e){t("Qjcx")},"data-v-0d09c778",null);a.default=s.exports},Qjcx:function(e,a){}});
//# sourceMappingURL=28.8a7f02d092c5b8aa6385.js.map